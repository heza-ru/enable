@import "tailwindcss";
@import "katex/dist/katex.min.css";

/* include utility classes in streamdown */
@source "../node_modules/streamdown/dist/index.js";

/* custom variant for setting dark mode programmatically */
@custom-variant dark (&:is(.dark, .dark *));

/* include plugins */
@plugin "tailwindcss-animate";
@plugin "@tailwindcss/typography";

/* define design tokens (light mode) */
:root {
  --background: 0 0% 100%;
  --foreground: 240 10% 3.9%;
  --card: 0 0% 100%;
  --card-foreground: 240 10% 3.9%;
  --popover: 0 0% 100%;
  --popover-foreground: 240 10% 3.9%;
  --primary: 240 5.9% 10%;
  --primary-foreground: 0 0% 98%;
  --secondary: 240 4.8% 92%;
  --secondary-foreground: 240 5.9% 10%;
  --muted: 240 4.8% 93%;
  --muted-foreground: 240 3.8% 46.1%;
  --accent: 240 4.8% 92%;
  --accent-foreground: 240 5.9% 10%;
  --destructive: 0 84.2% 60.2%;
  --destructive-foreground: 0 0% 98%;
  --border: 220 10% 65%;
  --input: 240 5.9% 85%;
  --ring: 240 10% 3.9%;
  --chart-1: 12 76% 61%;
  --chart-2: 173 58% 39%;
  --chart-3: 197 37% 24%;
  --chart-4: 43 74% 66%;
  --chart-5: 27 87% 67%;
  --sidebar-background: 0 0% 96%;
  --sidebar-foreground: 240 5.3% 26.1%;
  --sidebar-primary: 240 5.9% 10%;
  --sidebar-primary-foreground: 0 0% 98%;
  --sidebar-accent: 240 4.8% 93%;
  --sidebar-accent-foreground: 240 5.9% 10%;
  --sidebar-border: 220 13% 85%;
  --sidebar-ring: 217.2 91.2% 59.8%;
  /* border radius unit */
  --radius: 0.5rem;
  --sidebar: 0 0% 96%;
}

/* define design tokens (dark mode) */
.dark {
  --background: 240 10% 3.9%;
  --foreground: 0 0% 98%;
  --card: 240 10% 3.9%;
  --card-foreground: 0 0% 98%;
  --popover: 240 10% 3.9%;
  --popover-foreground: 0 0% 98%;
  --primary: 0 0% 98%;
  --primary-foreground: 240 5.9% 10%;
  --secondary: 240 3.7% 15.9%;
  --secondary-foreground: 0 0% 98%;
  --muted: 240 3.7% 15.9%;
  --muted-foreground: 240 5% 64.9%;
  --accent: 240 3.7% 15.9%;
  --accent-foreground: 0 0% 98%;
  --destructive: 0 62.8% 30.6%;
  --destructive-foreground: 0 0% 98%;
  --border: 240 3.7% 20%;
  --input: 240 3.7% 15.9%;
  --ring: 240 4.9% 83.9%;
  --chart-1: 220 70% 50%;
  --chart-2: 160 60% 45%;
  --chart-3: 30 80% 55%;
  --chart-4: 280 65% 60%;
  --chart-5: 340 75% 55%;
  --sidebar-background: 240 8% 6%;
  --sidebar-foreground: 240 4.8% 95.9%;
  --sidebar-primary: 224.3 76.3% 48%;
  --sidebar-primary-foreground: 0 0% 100%;
  --sidebar-accent: 240 5% 10%;
  --sidebar-accent-foreground: 240 4.8% 95.9%;
  --sidebar-border: 240 4% 12%;
  --sidebar-ring: 217.2 91.2% 59.8%;
  --sidebar: 240 8% 6%;
}

/* ============================================
   RESPONSIVE BREAKPOINTS
   ============================================ */
/* MacBook 13" = 1440x900 (effective 2880x1800) */
/* MacBook 15" = 1680x1050 (effective 3360x2100) */
/* Standard monitors = 1920x1080, 2560x1440 */

/* Enhanced Animations & Transitions */
* {
  transition-property:
    color, background-color, border-color, text-decoration-color, fill, stroke,
    opacity, box-shadow, transform, filter, backdrop-filter;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration: 150ms;
}

/* Spring physics for interactive elements */
button,
a,
[role="button"] {
  transition-timing-function: cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* Smooth scrolling */
html {
  scroll-behavior: smooth;
}

/* Custom spring animations */
@keyframes spring-in {
  0% {
    opacity: 0;
    transform: scale(0.9) translateY(10px);
  }
  50% {
    transform: scale(1.02);
  }
  100% {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

@keyframes slide-in-bottom {
  0% {
    opacity: 0;
    transform: translateY(20px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slide-in-right {
  0% {
    opacity: 0;
    transform: translateX(20px);
  }
  100% {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes fade-in {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}

@keyframes pulse-subtle {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0.8;
  }
}

@keyframes slide-in-left {
  0% {
    opacity: 0;
    transform: translateX(-20px);
  }
  100% {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes scale-in {
  0% {
    opacity: 0;
    transform: scale(0.95);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes shimmer {
  0% {
    background-position: -1000px 0;
  }
  100% {
    background-position: 1000px 0;
  }
}

@keyframes bounce-gentle {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-4px);
  }
}

@keyframes glow-pulse {
  0%, 100% {
    box-shadow: 0 0 5px rgba(var(--primary), 0.3);
  }
  50% {
    box-shadow: 0 0 20px rgba(var(--primary), 0.5);
  }
}

/* Micro-interactions */
.interactive-scale:active {
  transform: scale(0.98);
}

.interactive-lift:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.animate-slide-in-bottom {
  animation: slide-in-bottom 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}

.animate-slide-in-left {
  animation: slide-in-left 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}

.animate-slide-in-right {
  animation: slide-in-right 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}

.animate-scale-in {
  animation: scale-in 0.3s cubic-bezier(0.16, 1, 0.3, 1);
}

.animate-fade-in {
  animation: fade-in 0.3s ease-out;
}

.animate-spring-in {
  animation: spring-in 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* Mobile-first responsive utilities */
@media (max-width: 640px) {
  .hide-mobile {
    display: none !important;
  }
}

/* define theme */
@theme {
  --font-sans: var(--font-geist);
  --font-mono: var(--font-geist-mono);

  --breakpoint-toast-mobile: 600px;

  --radius-lg: var(--radius);
  --radius-md: calc(var(--radius) - 2px);
  --radius-sm: calc(var(--radius) - 4px);

  --color-background: var(--background);
  --color-foreground: var(--foreground);

  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);

  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);

  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);

  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);

  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);

  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);

  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);

  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);

  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);

  --color-sidebar: var(--sidebar-background);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

/*
  The default border color has changed to `currentcolor` in Tailwind CSS v4,
  so we've added these compatibility styles to make sure everything still
  looks the same as it did with Tailwind CSS v3.

  If we ever want to remove these styles, we need to add an explicit border
  color utility to any element that depends on these defaults.
*/
@layer base {
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-gray-200, currentcolor);
  }
}

@utility text-balance {
  text-wrap: balance;
}

@utility -webkit-overflow-scrolling-touch {
  -webkit-overflow-scrolling: touch;
}

@utility touch-pan-y {
  touch-action: pan-y;
}

@utility overscroll-behavior-contain {
  overscroll-behavior: contain;
}

@layer utilities {
  :root {
    --foreground-rgb: 0, 0, 0;
    --background-start-rgb: 214, 219, 220;
    --background-end-rgb: 255, 255, 255;
  }

  @media (prefers-color-scheme: dark) {
    :root {
      --foreground-rgb: 255, 255, 255;
      --background-start-rgb: 0, 0, 0;
      --background-end-rgb: 0, 0, 0;
    }
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    overflow-x: hidden;
    position: relative;
  }

  html {
    overflow-x: hidden;
  }
}

.skeleton {
  * {
    pointer-events: none !important;
  }

  *[class^="text-"] {
    color: transparent;
    @apply rounded-md bg-foreground/20 select-none animate-pulse;
  }

  .skeleton-bg {
    @apply bg-foreground/10;
  }

  .skeleton-div {
    @apply bg-foreground/20 animate-pulse;
  }
}

.ProseMirror {
  outline: none;
}

.cm-editor,
.cm-gutters {
  @apply bg-background! dark:bg-zinc-800! outline-hidden! selection:bg-zinc-900!;
}

.ͼo.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground,
.ͼo.cm-selectionBackground,
.ͼo.cm-content::selection {
  @apply bg-zinc-200! dark:bg-zinc-900!;
}

.cm-activeLine,
.cm-activeLineGutter {
  @apply bg-transparent!;
}

.cm-activeLine {
  @apply rounded-r-sm!;
}

.cm-lineNumbers {
  @apply min-w-7;
}

.cm-foldGutter {
  @apply min-w-3;
}

.cm-lineNumbers .cm-activeLineGutter {
  @apply rounded-l-sm!;
}

.suggestion-highlight {
  @apply bg-blue-200 hover:bg-blue-300 dark:hover:bg-blue-400/50 dark:text-blue-50 dark:bg-blue-500/40;
}

/* minimal scrollbar styling */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
  transition: background 0.2s ease;
}

::-webkit-scrollbar-thumb:hover {
  background: --alpha(var(--muted-foreground) / 0.5);
}

::-webkit-scrollbar-corner {
  background: transparent;
}

/* firefox scrollbar styling */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--border) transparent;
}

@theme inline {
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
  
  /* Remove number input spinners (green/red arrows) */
  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  
  input[type="number"] {
    -moz-appearance: textfield;
    appearance: textfield;
  }
  
  /* Remove validation styling from number inputs */
  input[type="number"]:invalid {
    box-shadow: none;
  }
  
  input[type="number"]:valid {
    box-shadow: none;
  }
}

/* ============================================
   RESPONSIVE UTILITIES
   ============================================ */
@layer utilities {
  /* Container queries for better component responsiveness */
  .container-responsive {
    container-type: inline-size;
  }

  /* Fluid typography */
  .text-fluid-sm {
    font-size: clamp(0.875rem, 0.8rem + 0.25vw, 1rem);
  }

  .text-fluid-base {
    font-size: clamp(1rem, 0.9rem + 0.5vw, 1.125rem);
  }

  .text-fluid-lg {
    font-size: clamp(1.125rem, 1rem + 0.625vw, 1.5rem);
  }

  .text-fluid-xl {
    font-size: clamp(1.25rem, 1.1rem + 0.75vw, 1.875rem);
  }

  .text-fluid-2xl {
    font-size: clamp(1.5rem, 1.25rem + 1.25vw, 2.25rem);
  }

  /* Scrollbar styles */
  .scrollbar-thin::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  .scrollbar-thin::-webkit-scrollbar-track {
    background: transparent;
  }

  .scrollbar-thin::-webkit-scrollbar-thumb {
    background: hsl(var(--border));
    border-radius: 3px;
  }

  .scrollbar-thin::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--muted-foreground) / 0.5);
  }

  /* Hide scrollbar but keep functionality */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* React Data Grid Custom Styles */
  .rdg {
    --rdg-color: hsl(var(--foreground));
    --rdg-background-color: hsl(var(--background));
    --rdg-header-background-color: hsl(var(--muted));
    --rdg-header-color: hsl(var(--foreground));
    --rdg-row-hover-background-color: hsl(var(--accent));
    --rdg-row-selected-background-color: hsl(var(--accent));
    --rdg-row-selected-hover-background-color: hsl(var(--accent) / 0.8);
    --rdg-border-color: hsl(var(--border));
    --rdg-summary-border-color: hsl(var(--border));
    --rdg-frozen-cell-box-shadow: 2px 0 5px -2px rgba(136, 136, 136, 0.3);
    
    border: 1px solid hsl(var(--border));
    font-size: 14px;
    block-size: 100%;
    inline-size: 100%;
    contain: size layout style paint;
  }

  .rdg-dark {
    --rdg-color: hsl(var(--foreground));
    --rdg-background-color: hsl(var(--background));
    --rdg-header-background-color: hsl(220 13% 18%);
    --rdg-header-color: hsl(var(--foreground));
    --rdg-row-hover-background-color: hsl(var(--accent));
    --rdg-row-selected-background-color: hsl(var(--accent));
    --rdg-row-selected-hover-background-color: hsl(var(--accent) / 0.8);
    --rdg-border-color: hsl(var(--border));
  }

  .rdg-cell {
    padding-block: 0;
    padding-inline: 8px;
    border-inline-end: 1px solid var(--rdg-border-color);
    border-block-end: 1px solid var(--rdg-border-color);
    contain: size layout style paint;
  }

  .rdg-header-row .rdg-cell {
    font-weight: 600;
  }

  /* Backdrop blur utilities */
  .backdrop-blur-custom {
    backdrop-filter: blur(12px) saturate(180%);
    -webkit-backdrop-filter: blur(12px) saturate(180%);
  }

  /* Glass morphism */
  .glass {
    background: hsl(var(--background) / 0.7);
    backdrop-filter: blur(12px) saturate(180%);
    -webkit-backdrop-filter: blur(12px) saturate(180%);
    border: 1px solid hsl(var(--border) / 0.2);
  }

  /* Gradient text */
  .gradient-text {
    background: linear-gradient(
      135deg,
      hsl(var(--primary)),
      hsl(var(--accent))
    );
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  /* ProseMirror Editor Styles - Force visible text */
  .ProseMirror {
    outline: none;
    min-height: 100px;
  }

  .ProseMirror p {
    margin: 0.75em 0;
  }

  .ProseMirror h1,
  .ProseMirror h2,
  .ProseMirror h3,
  .ProseMirror h4,
  .ProseMirror h5,
  .ProseMirror h6 {
    margin: 1em 0 0.5em;
    font-weight: 600;
  }

  .ProseMirror ul,
  .ProseMirror ol {
    padding-left: 1.5em;
  }

  .ProseMirror li {
    margin: 0.25em 0;
  }
}

/* ProseMirror text colors - Maximum specificity enforcement */
.ProseMirror,
.ProseMirror-content {
  color: #18181b !important;
  caret-color: #18181b !important;
}

.ProseMirror *,
.ProseMirror p,
.ProseMirror h1,
.ProseMirror h2,
.ProseMirror h3,
.ProseMirror h4,
.ProseMirror h5,
.ProseMirror h6,
.ProseMirror li,
.ProseMirror span,
.ProseMirror div,
.ProseMirror strong,
.ProseMirror em,
.ProseMirror code {
  color: #18181b !important;
}

.dark .ProseMirror,
.dark .ProseMirror-content {
  color: #fafafa !important;
  caret-color: #fafafa !important;
}

.dark .ProseMirror *,
.dark .ProseMirror p,
.dark .ProseMirror h1,
.dark .ProseMirror h2,
.dark .ProseMirror h3,
.dark .ProseMirror h4,
.dark .ProseMirror h5,
.dark .ProseMirror h6,
.dark .ProseMirror li,
.dark .ProseMirror span,
.dark .ProseMirror div,
.dark .ProseMirror strong,
.dark .ProseMirror em,
.dark .ProseMirror code {
  color: #fafafa !important;
}

/* Override any prose styles */
.prose .ProseMirror,
.prose-zinc .ProseMirror {
  color: #18181b !important;
}

.dark .prose .ProseMirror,
.dark .prose-zinc .ProseMirror {
  color: #fafafa !important;
}

/* ============================================
   MICRO-INTERACTIONS
   ============================================ */
@layer components {
  /* Button press effect */
  .btn-press {
    transition: transform 100ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .btn-press:active {
    transform: scale(0.97);
  }

  /* Lift effect */
  .lift-hover {
    transition:
      transform 200ms cubic-bezier(0.34, 1.56, 0.64, 1),
      box-shadow 200ms cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  .lift-hover:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px hsl(var(--primary) / 0.15);
  }

  /* Subtle glow on hover */
  .glow-hover {
    transition: box-shadow 200ms cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  .glow-hover:hover {
    box-shadow: 0 0 20px hsl(var(--primary) / 0.3);
  }

  /* Shine effect */
  .shine {
    position: relative;
    overflow: hidden;
  }

  .shine::before {
    content: "";
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.2),
      transparent
    );
    transition: left 600ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .shine:hover::before {
    left: 100%;
  }
}

/* ============================================
   MOBILE OPTIMIZATIONS
   ============================================ */
@media (max-width: 768px) {
  /* Reduce motion for mobile */
  @media (prefers-reduced-motion: no-preference) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  /* Better tap targets */
  button,
  a,
  [role="button"] {
    min-height: 44px;
    min-width: 44px;
  }

  /* Prevent text selection on mobile */
  .no-select-mobile {
    -webkit-user-select: none;
    user-select: none;
  }

  /* Safe area for notched devices */
  .safe-area-inset {
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
    padding-bottom: env(safe-area-inset-bottom);
  }
}

/* ============================================
   PRINT STYLES
   ============================================ */
@media print {
  .no-print {
    display: none !important;
  }

  body {
    background: white;
    color: black;
  }
}
